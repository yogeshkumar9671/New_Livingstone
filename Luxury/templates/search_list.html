{% extends 'base.html' %}
{% load static %}
{% block title %}{% endblock title %}
{% block description %}{% endblock description %}
{% block keywords %}{% endblock keywords %}
{% block page_css %}

<link rel="stylesheet" href="{% static 'styles/bootstrap4/bootstrap.min.css' %}" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link href="{% static 'plugins/malihu-custom-scrollbar/jquery.mCustomScrollbar.css' %}" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="{% static 'plugins/jquery-ui-1.12.1.custom/jquery-ui.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'styles/categories.css' %}">
<link rel="stylesheet" href="{% static 'styles/main_styles.css' %}" />
<link rel="stylesheet" href="{% static 'styles/responsive.css' %}" />
<link href=" https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/css/tom-select.bootstrap5.min.css" rel="stylesheet">





<style>

  .pt-5, .py-5 {
    padding-top: 5rem !important;
}
.main_nav ul li a {
    color: #000;
  }
  .header {
    color: white;
    background: transparent; 
    position: fixed
  }
  .header.scrolled {
   color: black; 
}
.logo a {
  color: black;
}
.header.scrolled .logo a {
  color: black;
}
.header .burger_container div {
  background: black;
}
.burger_container:hover div
{
	background: #937c6f;
}


  
.search-bar {
    display: flex;
    justify-content: center;
    margin-bottom: -53px;
    top: -85px;
}

.search-bar input {
    width: 400px;
    padding: 10px;
    border: 1px solid #ccc;
    font-size: 1rem;
}

.search-bar button {
    padding: 10px 20px;
    background-color: rgb(3 29 59);
    color: #fff;
    border: none;
    cursor: pointer;
    font-size: 1rem;
    margin-left: 10px;
}


.search-bar form {
    display: flex;
}


{% comment %} style fo count product and filter {% endcomment %}

.search-header {
  margin-top: 8rem;
}

.search-header h1 {
  display: flex;
  justify-content: center;
  font-size: 2rem;
  font-weight: 600;
  color: #333;
}

.search-product {
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  margin: 1.5rem 0;
  padding: 0 1rem;
  border-bottom: 1px solid #ddd;
  padding-bottom: 1rem;
}

.search-product p {
  margin: 0;
  font-size: 1rem;
  color: #555;
}

.sort-links {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  flex-wrap: wrap;
}

.sort-links strong {
  font-weight: 500;
  color: #000;
  margin-right: 0.5rem;
}

.sort-links a {
  text-decoration: none;
  color: #007bff;
  font-weight: 500;
  transition: color 0.2s ease;
}

.sort-links a:hover {
  color: #0056b3;
}

.btn{
  color: wheat!important;
   background-color: #031d3b  !important;
}



{% comment %} card styles {% endcomment %}

.card-img-top {
  height: 430px;
  object-fit: cover;
}

.card {
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.card-title,
.card-text {
  margin: 0 10px;
}

.card .btn {
  margin: 10px;
}


{% comment %} dropdown category style {% endcomment %}

.custom-dropdown-wrapper select.form-select {
  background-color: #f8f9fa;
  border-radius: 12px;
  border: 1px solid #ccc;
  font-weight: 500;
  transition: all 0.3s ease;
}

.custom-dropdown-wrapper select.form-select:focus {
  border-color: #0d6efd;
  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
}


{% comment %} style for price list {% endcomment %}

.custom-radio {
  margin-bottom: 0.5rem;
  transition: all 0.2s ease-in-out;
}

.custom-radio:hover {
  transform: translateX(5px);
  background-color: #f8f9fa;
  border-radius: 0.375rem;
}

.custom-radio .form-check-input {
  accent-color: #ff6f61; 
  transform: scale(1.1);
  transition: transform 0.2s;
}

.custom-radio .form-check-input:checked {
  box-shadow: 0 0 0 0.2rem rgba(255, 111, 97, 0.4);
}

.custom-radio .form-check-label {
  margin-left: 0.4rem;
  font-weight: 500;
  cursor: pointer;
}

{% comment %} style for sorting products {% endcomment %}


.search-product {
  background-color: #f9f9f9;
  padding: 1.2rem 1.5rem;
  border-radius: 0.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  margin-bottom: 2rem;
}

.search-product p {
  margin: 0 0 0.8rem;
  font-weight: 500;
  color: #333;
}

.sort-links {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  align-items: center;
  font-size: 0.95rem;
}

.sort-links strong {
  margin-right: 0.5rem;
  color: #555;
}

.sort-links a {
  color: #666;
  text-decoration: none;
  padding: 0.3rem 0.6rem;
  border-radius: 0.25rem;
  transition: all 0.2s ease;
}

.sort-links a:hover {
  background-color: #e9ecef;
  color: #000;
}

.sort-links .text-primary {
  color: #0d6efd !important;
  background-color: #e0ecff;
  border-radius: 0.25rem;
}



</style>


    
   
{% endblock page_css %}




{% block content %}
<div class="container search-header">
    <div >
        <h1 style="display: flex; justify-content: center;">Search Products</h1>
    </div>
</div>
<div class="container" style="margin-top: 8rem;">
    <div class="search-bar">
        {% comment %} <form method="post" action="{% url 'search' %}" style=" gap: 5px;"> {% endcomment %}
            <form method="get" action="{% url 'search' %}" style="gap: 5px;">
                <input type="text" name="q" placeholder="Enter your search query...">
                <button type="submit" class="close-btn-search">SEARCH</button>
            </form>            
    </div>       
    <hr>
    {% comment %} item sorting {% endcomment %}
    <div class="container mt-5">
      <div class="search-product">
    <p>
      Showing 1 – {{ products|length }} result{{ products|length|pluralize }} 
    </p>
    <div class="sort-links">
       <strong>Sort By:</strong>
       <a href="?q={{ query }}&subcategory={{ selected_subcategory }}&price={{ selected_price }}&sort=relevance" class="{% if sort == 'relevance' %}text-primary fw-bold{% endif %}">Relevance</a>
       <a href="?q={{ query }}&subcategory={{ selected_subcategory }}&price={{ selected_price }}&sort=popularity" class="{% if sort == 'popularity' %}text-primary fw-bold{% endif %}">Popularity</a>
       <a href="?q={{ query }}&subcategory={{ selected_subcategory }}&price={{ selected_price }}&sort=low_to_high" class="{% if sort == 'low_to_high' %}text-primary fw-bold{% endif %}">Price -- Low to High</a>
       <a href="?q={{ query }}&subcategory={{ selected_subcategory }}&price={{ selected_price }}&sort=high_to_low" class="{% if sort == 'high_to_low' %}text-primary fw-bold{% endif %}">Price -- High to Low</a>
       <a href="?q={{ query }}&subcategory={{ selected_subcategory }}&price={{ selected_price }}&sort=newest" class="{% if sort == 'newest' %}text-primary fw-bold{% endif %}">Newest First</a>
    </div>


        </div>
          <div class="row">
              <div class="col-md-3">
                 <div class="border p-3 rounded mb-4">
              <h5>Filters</h5>
              
              <form method="get">
                  <input type="hidden" name="q" value="{{ query }}">
                      <div class="mb-4">
                        <label for="subcategory" class="form-label fw-semibold text-uppercase text-secondary">Category</label>
                        <select name="subcategory" id="subcategory" class="form-select" onchange="this.form.submit()">
                          <option value="">🎯 Select Subcategory</option>

                          <optgroup label="👕 Men">                      
                            <option value="tshirt" {% if selected_subcategory == 'tshirt' %}selected{% endif %}>T-Shirt</option>
                            <option value="wallet" {% if selected_subcategory == 'wallet' %}selected{% endif %}>Wallet</option>
                            <option value="belt_men" {% if selected_subcategory == 'belt_men' %}selected{% endif %}>Belt</option>
                          </optgroup>

                          <optgroup label="👗 Women">
                            <option value="women_tshirt" {% if selected_subcategory == 'women_tshirt' %}selected{% endif %}>T-Shirt</option>
                            <option value="bag" {% if selected_subcategory == 'bag' %}selected{% endif %}>Bag</option>
                            <option value="women_belt" {% if selected_subcategory == 'women_belt' %}selected{% endif %}>Belt</option>
                          </optgroup>

                          <optgroup label="🧢 Accessories">
                            <option value="accessory_belt" {% if selected_subcategory == 'accessory_belt' %}selected{% endif %}>Belt</option>
                            <option value="accessory_wallet" {% if selected_subcategory == 'accessory_wallet' %}selected{% endif %}>Wallet</option>
                            <option value="accessory_caps" {% if selected_subcategory == 'accessory_caps' %}selected{% endif %}>Caps</option>
                            <option value="accessory_beer_mug" {% if selected_subcategory == 'accessory_beer_mug' %}selected{% endif %}>Beer Mug</option>
                          </optgroup>

                          <optgroup label="🏠 Home Decor">
                            <option value="candles" {% if selected_subcategory == 'candles' %}selected{% endif %}>Candles</option>
                          </optgroup>
                        </select>
                      </div>

                       <div style="margin-left: 13px;" class="mb-3">
                          <label class="form-label fw-bold">Price</label>

                          <div class="form-check custom-radio">
                           <input class="form-check-input" type="radio" name="price" value="0-500" id="price1"
                             {% if selected_price == '0-500' %}checked{% endif %}>
                            <label class="form-check-label" for="price1">Under ₹500</label>
                          </div>

                          <div class="form-check custom-radio">
                            <input class="form-check-input" type="radio" name="price" value="500-1000" id="price2"
                              {% if selected_price == '500-1000' %}checked{% endif %}>
                            <label class="form-check-label" for="price2">₹500 - ₹1000</label>
                          </div>

                          <div class="form-check custom-radio">
                            <input class="form-check-input" type="radio" name="price" value="1000-3000" id="price3"
                             {% if selected_price == '1000-3000' %}checked{% endif %}>
                            <label class="form-check-label" for="price3">₹1000 - ₹3000</label>
                          </div>

                          <div class="form-check custom-radio">
                           <input class="form-check-input" type="radio" name="price" value="3000-5000" id="price4"
                             {% if selected_price == '3000-5000' %}checked{% endif %}>
                            <label class="form-check-label" for="price4">₹3000 - ₹5000</label>
                          </div>

                          <div class="form-check custom-radio">
                            <input class="form-check-input" type="radio" name="price" value="5000-10000" id="price5"
                             {% if selected_price == '5000-10000' %}checked{% endif %}>
                            <label class="form-check-label" for="price5">₹5000 - ₹10000</label>
                          </div>
                        </div>


                    <form method="get">
                      <button type="submit" class="btn btn-dark">Apply Filters</button>
                  </form>
                </form>
            </div>
        </div>
        <div class="col-md-9">
            {% if products %}
                <div class="row mt-4">
                    {% for product in products %}
                        <div class="col-md-4 mb-4">
                            <div class="card h-100">
                                <img src="{{ product.image1.url }}" class="card-img-top" alt="{{ product.title }}">
                                <h2 style="font-size: 22px; margin-top: 10px; margin-left: 10px;" class="card-title">{{ product.title }}</h2>
                                <p style="margin-left: 10px;" class="card-text">Price: ₹{{ product.price }}</p>
                                <a style="color: black; border: 1px solid black;" href="{% url 'productdetails' product.id %}" class="btn btn-primary">View</a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                {% if query %}
                    <p>No results found for "{{ query }}"</p>
                {% endif %}
            {% endif %}
        </div>
    </div>
</div>





{% endblock content %}




{% block page_js %}

<!-- js for Filters Category dropdown -->
  <script src="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/js/tom-select.complete.min.js"></script>
<script>
  new TomSelect("#subcategory", {
    allowEmptyOption: true,
    dropdownInput: false,
    highlight: true,
    placeholder: "🎯 Select Subcategory",
    render: {
      option_create: function(data, escape) {
        return '<div class="create">Add <strong>' + escape(data.input) + '</strong>&hellip;</div>';
      }
    }
  });
</script>




  <script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
  <script src="{% static 'styles/bootstrap4/popper.js' %}"></script>
  <script src="{% static 'styles/bootstrap4/bootstrap.min.js' %}"></script>
  <script src="{% static 'plugins/OwlCarousel2-2.2.1/owl.carousel.js' %}"></script>
  <script src="{% static 'plugins/easing/easing.js' %}"></script>
  <script src="{% static 'plugins/parallax-js-master/parallax.min.js' %}"></script>
  <script src="{% static 'plugins/colorbox/jquery.colorbox-min.js' %}"></script>
  <script src="{% static 'js/custom.js' %}"></script>
  <script src="{% static 'script.js' %}"></script>


</body>
 {% endblock page_js %}
</html>